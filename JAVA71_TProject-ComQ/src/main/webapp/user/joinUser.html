<!DOCTYPE html>
<html>
<head>
		<meta charset='utf-8'>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>1111</title>
		
<style>
#propic-preview {
border: 1px solid black;
width: 250px;
height: 300px;
}
</style>
</head>
<body>
<form id="join-form" class="form-inline" method="POST" action="/app/user/joinUser" enctype="multipart/form-data">
  <div id ="user-email" class="form-group">
    <label for="exampleInputEmail2">Email
    <input type="email" class="form-control" id="input-email" name="usermail" placeholder="email@example.com" required>
    <button type="button" id="duplication-check">중복체크</button></label>
    
  </div><br>
   <div class="form-group">
    <label for="exampleInputPassword1">Password 입력</label>
    <input type="password" class="form-control" id="input-password" name="pwd" placeholder="비밀번호를 입력해주세요." required>
    <br/>
    <label for="exampleInputPassword2">Password 확인</label>
    <input type="password" class="form-control" id="check-password" placeholder="비밀번호 확인">
    <p id="pwd-check-output"></p>
    
  </div><br>
   <div class="form-group">
    <label for="exampleInputFile">파일 업로드</label>
    <input type="file" id="propic" name="propic" onchange="readURL(this)">
  </div>
  <div>
    <img id="propic-preview" src="#" alt="PreView uplaod images"/>
  </div>
  
  <br>
  	<button type="submit" id="join-submit" class="btn btn-default">회원가입</button>
</form>

<script  src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>
$(document).ready(function(){
	var joinCheck_email = false;
	var joinCheck_pwd = false;

 $('#duplication-check').on('click', function() {
		$.ajax({
			url: "/app/user/checkId",
			type: "POST",
			data: { "id" : $("#input-email").val() },
			success: function(data) {
				if(data == "false") {
					alert("이미 존재하는  e-mail 입니다.");	
				  joinCheck_email = false;
				  if(joinCheck_email == false) 
				      alert('joinCheck_email :: false');
				} else { 
					alert("사용 가능 합니다.");			
				  joinCheck_email = true;
				  if(joinCheck_email == true) 
				      alert('joinCheck_email :: ture');
				}
			}
	  });
 });
	 
	$('input[type=password]').keyup(function() {
	  var input_pwd = $('#input-password').val();
	  var check_pwd = $('#check-password').val();
	  
	  if (input_pwd == check_pwd) {
	    $('#pwd-check-output').text('비밀번호가 일치합니다.');
	    joinCheck_pwd = true;
	    if(joinCheck_pwd == true) 
	        alert('joinCheck_pwd :: ture');
	  } else {
	    $('#pwd-check-output').text('비밀번호가 일치하지 않습니다.');
	    joinCheck_email = false;
	    if(joinCheck_email == false) 
	    	alert('joinCheck_pwd :: false');
	  }
	}); 
	
	$('#join-form').submit(function(e) {
	 alert('회원가입');	
	 alert('joinCheck_email'+joinCheck_email);
	 alert('joinCheck_pwd'+joinCheck_pwd);
	 if(joinCheck_email == false) {
		 alert('email 확인');
		 e.preventDefault();
	 }
	 if(joinCheck_pwd == false) {
	   alert('pwd 확인');
	   e.preventDefault();
	 }
	});
	
});

function readURL(input) {
  if(input.files && input.files[0])  {
    if ( !(/image/i).test(input.files[0].type) ){
      alert("이미지 파일을 선택해 주세요!");
      return false;
    }
    var reader = new FileReader();
    reader.onload = function(e) {
      $('#propic-preview').attr('src', e.target.result);
    }
    reader.readAsDataURL(input.files[0]);
  }
}
</script>
</body>
</html>
		